<html>    
<head>
<title>Restlet JS Tests - JSONP</title> 
    
<link rel="stylesheet" href="../qunit/qunit.css" type="text/css" media="screen">
<script type="text/javascript" src="../jsclass/core.js"></script> 
<script type="text/javascript" src="../jsclass/console.js"></script> 
<script type="text/javascript" src="../qunit/qunit.js"></script> 
<script type="text/javascript" src="../jsonparser/json-minified.js"></script> 
<script type="text/javascript" src="../restlet/restlet-browser.js"></script> 

<script type="text/javascript"> 
module("JSONP Restlet JS client tests");

asyncTest("JSONP with Yahoo", function() {
	/*var yqlUrl1= "http://query.yahooapis.com/v1/public/yql?q=" +
			"select%20*%20from%20weather.forecast%20where%20location%3D10504&format=json";
	var clientResource = new ClientResource(yqlUrl1);*/
	var url= "http://query.yahooapis.com/v1/public/yql";
	var clientResource = new ClientResource(url);
	clientResource.addQueryParameter("q", "select * from weather.forecast where location=10504");
	clientResource.addQueryParameter("format", "json");

	Engine.getInstance().setDebugHandler({
		beforeSendingRequest: function(url, method, headers, data) {
		},
		afterReceivedResponse: function(status, statusText, headers, data) {
		}
	});

	clientResource.get(function(representation) {
		var obj = representation.getObject();
		//alert(obj.query.count);
		var content = representation.getText();
		ok(content, "{\"id\":\"1\",\"lastName\":\"lastName1\",\"firstName\":\"firstName1\",\"email\":null}");
		start();
	}, MediaType.APPLICATION_JSONP);
});

</script> 
</head>
 
<body>
<!-- QUnit will fill in the contents of these elements for you (except for qunit-header) --> 
    <h1 id="qunit-header">Basic QUnit Demo</h1>
    <h2 id="qunit-banner"></h2>
    <div id="qunit-testrunner-toolbar"></div>
    <h2 id="qunit-userAgent"></h2>
    <ol id="qunit-tests"></ol>
    <div id="qunit-fixture">test markup</div>
</body></html>